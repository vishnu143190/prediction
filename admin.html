<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Admin — Spin & Win (Simple)</title>
<style>
  body{font-family:system-ui,Arial; background:#071025;color:#eef2ff;margin:0;padding:28px}
  .wrap{max-width:900px;margin:0 auto;background:rgba(255,255,255,0.02);padding:18px;border-radius:10px}
  h1{margin:0 0 12px}
  input{width:100%;padding:12px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:#061322;color:#fff;box-sizing:border-box}
  .note{color:#9aa4b2;margin-top:8px}
  .editor{display:none;margin-top:14px;background:#04121a;padding:12px;border-radius:8px}
  textarea{width:100%;min-height:120px;padding:10px;border-radius:8px;background:#071827;color:#fff;border:1px solid rgba(255,255,255,0.04)}
  button{padding:10px 12px;border-radius:8px;border:0;background:#7c3aed;color:#fff;cursor:pointer}
  .row{display:flex;gap:8px;margin-top:8px}
</style>
</head>
<body>
  <div class="wrap">
    <h1>Admin — Spin & Win (Simple)</h1>
    <div>Enter admin password: <strong>admin123</strong></div>
    <div style="margin-top:12px">
      <input id="pw" placeholder="Enter admin password" autocomplete="off">
    </div>

    <div style="margin-top:12px" class="row">
      <button id="unlockBtn">Unlock</button>
    </div>

    <div id="editor" class="editor">
      <h3>Prize List</h3>
      <textarea id="prizes">10
20
30
40
Oops
Try Again</textarea>

      <div class="row" style="margin-top:10px">
        <button id="gen">Download index.html</button>
        <button id="preview">Preview</button>
      </div>
    </div>
  </div>

<script>
(function(){
  const DEFAULT = 'admin123';
  const pw = document.getElementById('pw');
  const unlockBtn = document.getElementById('unlockBtn');
  const editor = document.getElementById('editor');
  const genBtn = document.getElementById('gen');
  const previewBtn = document.getElementById('preview');

  function showEditor(){
    editor.style.display = 'block';
    pw.blur();
  }

  function tryUnlock(){
    const v = pw.value.trim();
    if(v === DEFAULT){
      showEditor();
    } else {
      alert('Wrong password');
    }
  }

  unlockBtn.addEventListener('click', tryUnlock);
  pw.addEventListener('keydown', function(e){
    if(e.key === 'Enter') tryUnlock();
  });

  function buildIndex(prizes){
    const p = prizes.map(s => s.replace(/`/g,'')).filter(Boolean);
    const prizeJs = p.map(s => JSON.stringify(s)).join(',');
    return `
<!doctype html>
<html><body>
<script>
const prizes=[${prizeJs}];
const sliceAngle=360/prizes.length;
let rotation=0;
function canSpin(){const last=localStorage.getItem('prediction_last_spin_ts');if(!last)return true;return(Date.now()-Number(last))>=86400000;}
function spin(){if(!canSpin()){alert('One spin per day');return;}const idx=Math.floor(Math.random()*prizes.length);const extra=4+Math.floor(Math.random()*4);const angle=360*extra+(360-(idx*sliceAngle)-sliceAngle/2);rotation+=angle;setTimeout(()=>{const norm=(360-(rotation%360))%360;const landed=Math.floor(norm/sliceAngle)%prizes.length;const prize=prizes[landed];alert(prize==='Oops'||prize==='Try Again'?prize:'Congratulations! You won: '+prize);localStorage.setItem('prediction_last_spin_ts',String(Date.now()));},2100);}
window.onload=function(){const b=document.createElement('button');b.textContent='SPIN NOW';b.style.fontSize='20px';b.onclick=spin;document.body.appendChild(b);}
</script>
</body></html>`;
  }

  genBtn.addEventListener('click', function(){
    const raw = document.getElementById('prizes').value.split('\n').map(s=>s.trim());
    const html = buildIndex(raw);
    const blob = new Blob([html], {type:'text/html'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a'); a.href=url; a.download='index.html'; a.click();
  });

  previewBtn.addEventListener('click', function(){
    const raw = document.getElementById('prizes').value.split('\n').map(s=>s.trim());
    const html = buildIndex(raw);
    const w = window.open(); w.document.write(html); w.document.close();
  });

})();
</script>
</body>
</html>
